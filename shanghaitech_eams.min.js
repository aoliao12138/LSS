var selectNos=["EE111.04","CSKI1002.01","CS140.01"];var selectIds=[];lessonJSONs.forEach(lesson=>{for(idx in selectNos){if(lesson.no===selectNos[idx]){selectIds.push(lesson.id);break}}});var retires=0;var pos=0;setInterval(()=>{$.ajax({type:"POST",url:`http://eams.shanghaitech.edu.cn/eams/stdElectCourse!batchOperator.action?profileId=${electCourseTable.config.profileId}`,data:{optype:true,operator0:`${selectIds[pos]}:true:0`},async:false,success:data=>{let res=(data.match(/.*<\/br>|请不要过快点击/g)||[]).map(l=>l.replace(/<.*?>/g,"").trim());retires++;if(data.indexOf("失败")>0||data.indexOf("请不要过快点击")>0){console.log("[x] Failed",retires,res);pos=(pos+1)%selectIds.length}else{console.log("[√] Succeed",retires,res);selectIds.splice(pos,1);if(selectIds.length>0){pos%=selectIds.length}}},error:(xhr,textStatus,error)=>{retires++;pos=(pos+1)%selectIds.length;console.log("[x] Error",retires,xhr.statusText,textStatus,error)}})},1500);
